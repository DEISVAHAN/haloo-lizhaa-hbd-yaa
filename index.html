<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Situs Web Luar Biasa Saya - Windows 95 Style</title>
    <!-- Tailwind CSS for basic structure and responsive utility -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Menggunakan font yang menyerupai antarmuka Windows 95 */
        @font-face {
            font-family: 'W95Font';
            /* Ini hanya placeholder, kita akan menggunakan 'Inter' dan meniru gayanya. */
            src: url('https://fonts.gstatic.com/s/inter/v12/UuJ1lP9w3x-T3L2W8g2P0A.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
        }

        body {
            font-family: 'W95Font', 'Inter', sans-serif;
            background-color: #0000a8; /* Warna Biru Klasik */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-size: 11px;
        }
        
        /* --- Global W95 Style --- */
        .w95-base {
            background-color: #c0c0c0; /* Abu-abu Ikonik */
            border-style: solid;
            border-width: 2px;
            border-color: #ffffff #808080 #808080 #ffffff;
            box-shadow: 1px 1px 0 #000000;
        }
        
        .w95-window {
            position: absolute;
            display: none; 
            flex-direction: column;
            z-index: 20; 
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .w95-raised {
            border-style: solid;
            border-width: 2px;
            border-color: #ffffff #808080 #808080 #ffffff;
        }

        .w95-sunken {
            border-style: solid;
            border-width: 2px;
            border-color: #808080 #ffffff #ffffff #808080;
            box-shadow: inset 1px 1px 0 #000000;
        }

        .w95-title-bar {
            background-color: #000080;
            color: white;
            padding: 2px 4px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
        }

        .w95-button {
            background-color: #c0c0c0;
            color: #000000;
            font-size: 12px;
            padding: 1px 6px;
            margin: 0 1px;
            cursor: pointer;
            line-height: normal;
            min-width: 16px;
            text-align: center;
            border-style: solid;
            border-width: 2px;
            border-color: #ffffff #000000 #000000 #ffffff;
            box-shadow: 1px 1px 0 #000000;
        }

        .w95-button:active:not(:disabled) {
            border-color: #000000 #ffffff #ffffff #000000;
            box-shadow: inset 1px 1px 0 #000000;
            transform: translate(1px, 1px);
        }
        
        .w95-button:disabled {
            color: #808080;
            border-color: #c0c0c0 #c0c0c0 #c0c0c0 #c0c0c0;
            box-shadow: none;
            cursor: default;
        }
        
        .window-content-wrapper {
            padding: 10px;
            background-color: #c0c0c0;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            overflow: auto;
        }

        /* --- Custom Window Styles --- */
        
        /* Photo Strip Styles (NEW) */
        .photo-strip-base {
            width: 90px;
            height: 380px;
            padding: 10px 8px;
            border-radius: 12px;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            align-items: center;
            overflow: hidden;
            margin: 0 5px;
            transition: transform 0.3s ease;
            cursor: pointer; /* Agar terasa interaktif */
        }
        .photo-strip-base:hover {
            transform: scale(1.03) rotate(1deg);
        }

        .strip-image-frame {
            width: 100%;
            height: 70px;
            background-color: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            border-radius: 4px;
            border: 2px solid #fff;
        }

        .strip-image-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .strip-text-bottom {
            font-size: 8px;
            font-weight: bold;
            text-align: center;
            color: white;
            margin-top: 5px;
            line-height: 1;
            text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
            padding: 5px 0;
        }

        /* Template 1: Orange/Yellow Vibe */
        .strip-template-1 {
            background: linear-gradient(180deg, #ffcc00 0%, #ff8c00 100%);
            border: 3px solid white;
        }

        /* Template 2: Pink/Red Vibe */
        .strip-template-2 {
            background: linear-gradient(180deg, #ff69b4 0%, #ff1493 100%);
            border: 3px solid white;
        }

        /* Template 3: Purple Vibe */
        .strip-template-3 {
            background: linear-gradient(180deg, #9370db 0%, #6a5acd 100%);
            border: 3px solid white;
        }


        /* [Sisanya adalah CSS dari versi sebelumnya, dipersingkat di sini] */
        /* --- LOADING SCREEN STYLES --- */
        #loading-dialog {
            position: fixed;
            z-index: 9999;
            width: 350px;
            max-width: 90%;
            text-align: center;
            padding: 2px;
        }
        
        .progress-bar-container {
            height: 18px;
            margin-top: 10px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #00ff00;
            transition: width 0.3s linear;
        }
        .progress-bar.active {
            background-image: linear-gradient(-45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
            background-size: 15px 15px;
            animation: progress-stripes 1s linear infinite;
        }
        @keyframes progress-stripes {
            0% { background-position: 15px 0; }
            100% { background-position: 0 0; }
        }

        /* --- DESKTOP COMPONENTS --- */
        .desktop {
            display: none;
            width: 100vw;
            height: 100vh; 
            background-color: #0000a8; 
            position: relative;
            box-shadow: none; 
            padding: 5px;
            box-sizing: border-box;
            flex-direction: column; 
            align-items: flex-start;
            justify-content: flex-start;
        }
        
        /* Taskbar */
        .taskbar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 28px;
            background-color: #c0c0c0;
            display: flex;
            align-items: center;
            padding: 2px;
            border-top: 2px solid #ffffff;
            z-index: 10;
        }

        .start-button {
            width: 50px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            border-style: solid;
            border-width: 2px;
            border-color: #ffffff #000000 #000000 #ffffff;
            height: 22px;
            line-height: 1;
            padding: 0 4px;
            margin-right: 4px;
            background: #c0c0c0;
            cursor: pointer;
        }
        .start-button:active {
            border-color: #000000 #ffffff #ffffff #000000;
            box-shadow: inset 1px 1px 0 #000000;
        }

        /* --- START MENU STYLES --- */
        #start-menu {
            position: absolute;
            bottom: 32px; /* Di atas taskbar */
            left: 2px;
            width: 200px;
            background-color: #c0c0c0;
            display: none;
            flex-direction: column;
            border-style: solid;
            border-width: 2px;
            border-color: #ffffff #000000 #000000 #ffffff;
            box-shadow: 2px 2px 0 #000000;
            z-index: 50; 
        }

        .start-menu-sidebar {
            width: 25px;
            background-color: #808080;
            color: #c0c0c0;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            padding-bottom: 5px;
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            white-space: nowrap;
            letter-spacing: 2px;
            text-shadow: 1px 1px 0 #000000;
            border-right: 2px solid #000000;
        }

        .start-menu-item {
            display: flex;
            align-items: center;
            padding: 3px 5px;
            cursor: pointer;
            border-bottom: 1px solid transparent; 
            border-top: 1px solid transparent;
        }

        .start-menu-item:hover {
            background-color: #000080;
            color: white;
        }
        
        .start-menu-item-icon {
            font-size: 16px;
            width: 24px;
            text-align: center;
            margin-right: 5px;
        }

        /* Separator dan item Shutdown */
        .start-menu-separator {
            height: 2px;
            margin: 2px 0;
            background-color: #ffffff;
            border-top: 1px solid #808080;
        }
        
        .shutdown-item {
            margin-top: auto; /* Dorong ke bawah */
            border-top: 2px solid #808080;
        }

        /* --- Custom Window Styles --- */
        #notepad-window {
            width: 450px;
            max-width: 90%;
            height: 350px;
        }

        .notepad-area {
            flex-grow: 1;
            background-color: white;
            padding: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            resize: none;
            border: none;
            outline: none;
        }
        
        /* --- SHUTDOWN SCREEN STYLES (Neon Glow) --- */
        #shutdown-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: black;
            color: white;
            z-index: 10000;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .shutdown-message {
            font-size: 3rem;
            font-weight: bold;
            color: #ff00ff; /* Pink/Magenta Neon */
            /* EFEK NEON GLOW */
            text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 30px #ff00ff;
            animation: pulse-glow 2s infinite alternate;
        }

        @keyframes pulse-glow {
            0% { text-shadow: 0 0 5px #ff00ff, 0 0 10px #ff00ff; opacity: 0.8; }
            100% { text-shadow: 0 0 15px #ff00ff, 0 0 40px #ff00ff; opacity: 1; }
        }
        
        /* Responsif: Pastikan elemen terlihat bagus di perangkat kecil */
        @media (max-width: 768px) {
            .desktop {
                height: 90vh;
                margin-top: 10px;
                padding: 5px;
            }
            .w95-window {
                width: 95%; 
                height: auto; 
                max-height: 90vh;
                top: 5vh; 
                left: 2.5%; 
                transform: none;
            }
            #start-menu {
                width: 150px;
            }
            .shutdown-message {
                font-size: 2rem;
            }
        }

        /* --- GALLERY STYLES ADJUSTMENTS (PENYESUAIAN UKURAN GAMBAR) --- */
        .image-display-area {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            padding: 10px;
            background-color: #808080;
            min-height: 300px; /* Sedikit lebih kecil */
        }
        .polaroid {
            background-color: white;
            padding: 8px 8px 16px 8px; /* Padding lebih kecil */
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
            max-width: 95%;
            max-height: 90%;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .gallery-image {
            display: block;
            max-width: 350px; /* Max lebar gambar */
            max-height: 250px; /* Max tinggi gambar agar tidak terlalu besar */
            height: auto;
            width: auto;
            border: 1px solid #ccc;
            object-fit: cover; /* Memastikan gambar menutupi area tanpa distorsi besar */
        }
        
        /* --- VIDEO PLAYER STYLES ADJUSTMENTS (PENYESUAIAN UKURAN VIDEO) --- */
        .video-container-wrapper {
            flex-grow: 1;
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 5px; /* Tambahkan padding di sekitar video */
        }
        #mediaVideo {
            width: 100%;
            height: 100%;
            object-fit: contain; /* PENTING: Memastikan video terlihat penuh tanpa terpotong di dalam wadahnya */
            background-color: black;
        }

        /* --- STYLES FOR OTHER WINDOWS (Kept for completeness) --- */
        .birthday-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #000080;
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 3px solid #000080;
            padding-bottom: 5px;
        }
        .birthday-main-text {
            font-size: 1.5rem;
            font-weight: bold;
            color: red;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 1px 1px 0 #fff;
        }
        .message-box-area {
            background-color: white;
            border: 1px solid #808080;
            padding: 10px;
            min-height: 150px;
            white-space: pre-wrap;
            font-family: monospace;
            overflow: auto;
        }
        .cake-visual {
            font-size: 100px;
            text-align: center;
            position: relative;
        }
        .candle-container {
            position: absolute;
            top: 25px; 
            left: 50%;
            transform: translateX(-50%);
        }
        .candle {
            position: relative;
            width: 10px;
            height: 30px;
            background-color: white;
            border: 1px solid #000;
        }
        .wick {
            position: absolute;
            top: -4px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 5px;
            background-color: #5d4037;
        }
        .flame {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 12px;
            background-color: #ffcc00;
            border-radius: 50%;
            box-shadow: 0 0 5px #ffcc00, 0 0 10px #ff6600, 0 0 15px #ff3300;
            animation: flicker 0.5s infinite alternate;
        }
        @keyframes flicker {
            0% { transform: translate(-50%, 0) scale(1, 1); opacity: 0.9; }
            50% { transform: translate(-50%, -1px) scale(0.95, 1.05); opacity: 0.8; }
            100% { transform: translate(-50%, 0) scale(1.05, 0.95); opacity: 0.9; }
        }
        .prayer-reminder {
            text-align: center;
            margin-top: 10px;
            font-style: italic;
            font-size: 12px;
        }
        .action-button-group {
            display: flex;
            justify-content: space-around;
            padding: 8px;
            margin-top: 10px;
        }
        .desktop-icon {
            text-align: center;
            margin: 10px;
            width: 60px;
            cursor: pointer;
            padding: 5px;
        }
        .desktop-icon:hover {
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px dotted #ffffff;
        }
        .icon-box {
            font-size: 30px;
            line-height: 1;
        }
        .taskbar-time {
            padding: 0 6px;
            height: 22px;
            line-height: 20px;
        }
        /* Gallery Styles */
        .gallery-content-wrapper {
            position: relative;
        }
        
        .caption {
            text-align: center;
            font-size: 14px;
            margin-top: 5px;
        }
        .navigation-buttons button {
            margin: 0 5px;
        }
        
        /* Loading icon for print simulation */
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-top: 4px solid #000080;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <!-- Tambahkan pustaka html2canvas untuk mengonversi HTML menjadi gambar -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body class="bg-gray-800">

    <!-- 1. LOADING SCREEN (Awalnya terlihat) -->
    <div id="loading-dialog" class="loading-dialog w95-base">
        <div class="w95-title-bar" style="cursor: default;">
            <div class="title-bar-text">Memuat Sistem Berkas...</div>
            <div class="flex">
                <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;">X</div>
            </div>
        </div>

        <div class="dialog-content p-4">
            <p style="font-size: 14px; margin-bottom: 15px;">
                <strong>Memuat Antarmuka Desktop 32-bit (Simulasi)...</strong>
            </p>
            <div class="progress-bar-container w95-sunken">
                <div id="progressBar" class="progress-bar active"></div>
            </div>
            <p id="progressText" style="margin-top: 10px; font-size: 12px;">0% Selesai</p>
        </div>
    </div>
    
    <!-- 2. SHUTDOWN SCREEN (Sesuai Permintaan: Loading Hitam + Teks Neon I Love You) -->
    <div id="shutdown-screen" style="display: none;">
        <div id="shutdown-text" class="shutdown-message">
            <span class="text-4xl">üíñ</span> I LOVE YOU! <span class="text-4xl">‚ú®</span>
        </div>
        <p class="text-xl mt-4 font-mono">Sampai jumpa lagi...</p>
    </div>

    <!-- 3. DESKTOP SCREEN (Awalnya tersembunyi) -->
    <div class="desktop" id="desktop">
        
        <!-- START MENU (BARU - Sesuai Permintaan) -->
        <div id="start-menu" class="flex">
            <!-- Sidebar Abu-abu Tua -->
            <div class="start-menu-sidebar">
                <!-- Teks 'Sistem Ulang Tahun' dihapus sesuai permintaan -->
            </div>
            <!-- Item Menu -->
            <div class="flex flex-col w-full">
                <!-- Pilihan Aplikasi -->
                <div class="flex-grow flex flex-col pt-1">
                    <div class="start-menu-item" onclick="handleStartMenuAction('ucapan')">
                        <div class="start-menu-item-icon">üíå</div>
                        Kartu Ucapan
                    </div>
                    <div class="start-menu-item" onclick="handleStartMenuAction('kue')">
                        <div class="start-menu-item-icon">üéÇ</div>
                        Kue Ulang Tahun
                    </div>
                    <div class="start-menu-item" onclick="handleStartMenuAction('notepad')">
                        <div class="start-menu-item-icon">üìù</div>
                        Notepad
                    </div>
                    <div class="start-menu-separator"></div>
                    <div class="start-menu-item" onclick="handleStartMenuAction('restart')">
                        <div class="start-menu-item-icon">üîÑ</div>
                        Restart
                    </div>
                    <div class="start-menu-item" onclick="handleStartMenuAction('tentang')">
                        <div class="start-menu-item-icon">‚ùì</div>
                        Tentang
                    </div>
                </div>
                
                <!-- Shutdown Item -->
                <div class="start-menu-item shutdown-item" onclick="handleStartMenuAction('shutdown')">
                    <div class="start-menu-item-icon">üõë</div>
                    Shutdown
                </div>
            </div>
        </div>
        
        <!-- JENDELA NOTEPAD (Sesuai Permintaan) -->
        <div id="notepad-window" class="w95-base w95-window">
            <!-- Title Bar -->
            <div class="w95-title-bar" data-draggable="notepad-window">
                <div class="title-bar-text">Tanpa Judul - Notepad</div>
                <div class="flex">
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;">_</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;">&#9744;</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;" onclick="closeNotepadWindow()">X</div>
                </div>
            </div>

            <!-- Menu Bar (Simplified) -->
            <div class="menu-bar">
                <span class="menu-item"><u>F</u>ile</span>
                <span class="menu-item"><u>E</u>dit</span>
                <span class="menu-item"><u>F</u>ormat</span>
                <span class="menu-item"><u>V</u>iew</span>
                <span class="menu-item"><u>H</u>elp</span>
            </div>

            <!-- Window Content -->
            <div class="window-content-wrapper p-0 flex flex-col">
                <textarea class="notepad-area w95-sunken" id="notepad-textarea">
Selamat datang di Notepad!

Ini adalah tempat untuk menuliskan semua ide brilian yang tiba-tiba muncul di kepala Anda. 

Catatan Penting:
1. Hari ini adalah hari spesial!
2. Jangan lupa makan kue.
3. Tetap bahagia selalu!
                </textarea>
            </div>
        </div>

        <!-- JENDELA KARTU UCAPAN (present.exe) -->
        <div id="birthday-window" class="w95-base w95-window" style="width: 70vw; max-width: 700px; height: 75vh; max-height: 750px; min-width: 300px;">
            <!-- Title Bar -->
            <div class="w95-title-bar" data-draggable="birthday-window">
                <div class="title-bar-text">HAPPY BIRTHDAY.TXT</div>
                <div class="flex">
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;">_</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;">&#9744;</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;" onclick="closeBirthdayWindow()">X</div>
                </div>
            </div>

            <div class="menu-bar">
                <span class="menu-item"><u>F</u>ile</span>
                <span class="menu-item"><u>E</u>dit</span>
            </div>

            <div class="window-content-wrapper w95-scroll">
                <div class="birthday-header">
                    <div class="birthday-title">üéâ ‚ù§Ô∏è HAPPY BIRTHDAY ‚ù§Ô∏è üéâ</div>
                </div>

                <div class="birthday-main-text">
                    SELAMAT ULANG TAHUN KE-27
                </div>

                <!-- Message Box (Simulated Text Area) -->
                <div class="message-container">
                    <div class="message-label">MESSAGE.TXT</div>
                    <div class="message-box-area w95-sunken" style="flex-grow: 1;">
Haiii, selamat ulang tahun! Hari ini aku pengen kamu 
ngerasain semua vibes positif dan kebahagiaan yang cuma bisa 
didapetin kalo kamu ada di sini. Semoga segala keinginanmu 
tercapai, apalagi yang kocak-kocak, jangan gak biasa, karena kamu 
tuh unik banget. Aku selalu bersyukur bisa ngeliat kamu jadi 
versi terbaik dari dirimu, yang kadang-kadang lucu banget pas 
lagi laper, tapi juga selalu bikin aku tersenyum tanpa henti.

Makasih udah jadi temen curhat, partner in crime, dan sumber 
inspirasi sehari-hari. Semoga tahun ini kamu makin kece, makin 
banyak momen bahagia, dan makin dicintai, karena kamu emang 
pantas dapetin semua itu. Jangan lupa, kita bakal terus jalan 
bareng, ngejar mimpi, dan ngelewatin segala drama hidup dengan 
ketawa paling kenceng.

Love and best wishes,
- Teman Terbaikmu
                    </div>
                </div>
            </div>
        </div>
        
        <!-- JENDELA CAKE.ME (TIUP LILIN) -->
        <div id="cake-window" class="w95-base w95-window" style="width: 450px; max-width: 90%; height: auto;">
            <!-- Title Bar -->
            <div class="w95-title-bar" data-draggable="cake-window">
                <div class="title-bar-text">CAKE.ME - TIUP LILIN</div>
                <div class="flex">
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;">_</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;">&#9744;</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;" onclick="closeCakeWindow()">X</div>
                </div>
            </div>
            
            <div class="window-content-wrapper flex flex-col">
                <div class="cake-container">
                    <div class="w95-title-bar w-full mb-5" style="background-color: #ff9900; color: black; border-color: #ffd700 #cc7a00 #cc7a00 #ffd700; cursor: default;">
                        <span class="mx-auto text-lg font-extrabold">AYO TIUP DULU</span>
                    </div>

                    <!-- Visual Kue dengan Lilin Api Animasi -->
                    <div class="cake-visual">
                        üéÇ
                        <div class="candle-container">
                            <div class="candle">
                                <div class="wick"></div>
                                <div class="flame"></div>
                            </div>
                        </div>
                    </div>
                    
                    <p class="prayer-reminder w-full">
                        jangan lupa berdoa dulu yaa sebelum tiup lilin...
                    </p>

                </div>

                <!-- Tombol Aksi -->
                <div class="action-button-group w95-raised">
                    <button class="w95-button" onclick="showMessageDialog('Doa', document.getElementById('prayer-text').innerHTML)">
                        yuk berdoa
                    </button>
                    <button class="w95-button" onclick="closeCakeWindow()">
                        tiup lilin
                    </button>
                </div>
            </div>
        </div>

        <!-- Hidden content for prayer text -->
        <div id="prayer-text" style="display: none;">
            <p class="text-sm font-bold text-center mb-4 text-red-700">DOA KESELAMATAN & KEBERKAHAN</p>
            <div class="w95-sunken p-4 bg-white w-full text-center" style="min-height: 80px;">
                <p class="text-sm font-serif italic" style="line-height: 1.5;">
                    "Allohumma Inni As‚Äôaluka salamatan fid dinni wa dunya Wal Aakhiroh Wa ‚Äòafayitan fii rizqi Wa barokatan fii ‚Äòumri"
                </p>
            </div>
        </div>

        <!-- MESSAGE DIALOG (Modal Pop-up) -->
        <div id="message-dialog" class="w95-base w95-window" style="width: 400px; max-width: 90%; z-index: 30; padding: 2px;">
            <!-- Title Bar -->
            <div class="w95-title-bar" data-draggable="message-dialog">
                <div class="title-bar-text" id="messageTitle">PESAN SISTEM</div>
                <div class="flex">
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;" onclick="closeMessageDialog()">X</div>
                </div>
            </div>
            
            <div class="dialog-content flex flex-col items-center p-4">
                <div id="messageContent" class="w-full text-center">
                    <!-- Isi Pesan Masuk Di Sini -->
                </div>
                <div class="mt-5">
                    <button class="w95-button" onclick="closeMessageDialog()">
                        OK
                    </button>
                </div>
            </div>
        </div>

        <!-- JENDELA PRINT SIMULATION (BARU) -->
        <div id="print-simulation-window" class="w95-base w95-window" style="width: 350px; max-width: 90%; height: auto; z-index: 40; padding: 2px;">
            <!-- Title Bar -->
            <div class="w95-title-bar" data-draggable="print-simulation-window">
                <div class="title-bar-text">Print Manager - Hasil Cetak</div>
                <div class="flex">
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;" onclick="closePrintSimulation()">X</div>
                </div>
            </div>
            <div class="dialog-content flex flex-col items-center p-4">
                <p class="mb-4 font-bold text-center text-sm">üéâ Hasil Cetak Photo Strip üéâ</p>
                <div id="photoStripContainer" class="w-full flex justify-center flex-wrap">
                    <!-- Photo Strip will be injected here by JavaScript -->
                    <div class="loading-spinner"></div>
                    <p class="text-sm text-gray-700">Memproses cetakan...</p>
                </div>
                <p id="printStatusText" class="mt-4 text-xs text-gray-700">Dokumen telah selesai dicetak.</p>
                <div class="mt-5 flex gap-3">
                    <button class="w95-button" onclick="closePrintSimulation()">
                        Tutup
                    </button>
                    <!-- Tombol Unduh BARU -->
                    <button class="w95-button" onclick="downloadStrips()">
                        ‚¨áÔ∏è Unduh Semua (.png)
                    </button>
                </div>
            </div>
        </div>

        <!-- JENDELA MUSIC PLAYER -->
        <div id="music-window" class="w95-base w95-window" style="width: 350px; max-width: 90%; height: auto;">
            <div class="w95-title-bar" data-draggable="music-window">
                <div class="title-bar-text">MUSIC_PLAYER.EXE</div>
                <div class="flex">
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;">_</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;">&#9744;</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;" onclick="closeMusicWindow()">X</div>
                </div>
            </div>
            <!-- Mengubah src menjadi URL placeholder, asumsikan pengguna akan mengunggah file yang sesuai -->
            <audio id="hbdAudio" src="./hbd.mp3" preload="auto" loop></audio> 
            <div class="music-player-body flex flex-col items-center">
                <div class="text-center mb-3">
                    <p id="trackTitle" class="font-bold text-sm">hbd.mp3</p>
                    <p class="text-xs">Ulang Tahun Klasik</p>
                </div>
                <div id="playPauseButton" class="play-button-center mb-5" onclick="togglePlayback()">
                    <span id="playIcon">‚ñ∂</span> 
                </div>
                <div class="flex justify-between w-full text-xs mb-1">
                    <span id="currentTimeDisplay">00:00</span>
                    <span id="durationDisplay">00:00</span>
                </div>
                <div class="time-bar-container w-full mb-5">
                    <div id="timeBarProgress" class="time-bar-progress"></div>
                </div>
                <div class="flex items-center w-full">
                    <span class="text-xl mr-2">üîä</span>
                    <div id="volumeSliderContainer" class="slider-container flex-grow">
                        <div id="volumeSliderFill" class="slider-fill" style="width: 70%;">
                            <div class="slider-thumb" id="volumeSliderThumb"></div>
                        </div>
                    </div>
                </div>
                <div class="w95-sunken w-full mt-4 text-center text-xs p-1" style="height: 20px; line-height: 14px;">
                    <span id="playbackStatus">READY</span>
                </div>
            </div>
        </div>

        <!-- JENDELA GALLERY VIEWER -->
        <div id="gallery-window" class="w95-base w95-window" style="width: 650px; max-width: 95%; height: 80vh; max-height: 750px; min-width: 350px;">
            <div class="w95-title-bar" data-draggable="gallery-window">
                <div class="title-bar-text">GALLERY VIEWER</div>
                <div class="flex">
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;">_</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;">&#9744;</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;" onclick="closeGalleryWindow()">X</div>
                </div>
            </div>
            <div class="gallery-content-wrapper flex flex-col items-center w95-scroll p-4">
                <div class="w95-raised absolute top-3 right-3 p-1 text-xs" id="imageCounter">1/4</div>
                <div class="image-display-area" style="min-height: 350px;">
                    <div class="polaroid">
                        <!-- Gunakan URL placeholder jika file tidak ditemukan -->
                        <img id="currentImage" src="" alt="Galeri Foto" class="gallery-image"
                             onerror="this.onerror=null; this.src='https://placehold.co/400x300/c0c0c0/000000?text=File\nTidak\nDitemukan\n(Unggah\nFile)';">
                        <div class="caption" id="imageCaption">Caption Foto</div>
                    </div>
                </div>
                <div class="navigation-buttons w-full flex justify-center py-4 px-2 mt-auto">
                    <button id="prevButton" class="w95-button" onclick="showPrevImage()">
                        &lt; Sebelumnya
                    </button>
                    <button id="nextButton" class="w95-button" onclick="showNextImage()">
                        Berikutnya &gt;
                    </button>
                    <button class="w95-button" onclick="openVideoWindow('Video Kenangan', './vid1.mp4')">
                        Lihat Video
                    </button>
                    <!-- Tombol Cetak yang memanggil simulasi cetak -->
                    <button class="w95-button" onclick="openPrintSimulation()">
                        Cetak
                    </button>
                </div>
            </div>
        </div>

        <!-- JENDELA VIDEO PLAYER -->
        <div id="video-window" class="w95-base w95-window" style="width: 600px; max-width: 90%; height: 400px; min-width: 300px;">
            <div class="w95-title-bar" data-draggable="video-window">
                <div class="title-bar-text" id="videoTitleBar">MEDIA PLAYER - Video Kenangan</div>
                <div class="flex">
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0;">_</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;">&#9744;</div>
                    <div class="w95-button" style="width: 14px; height: 14px; font-size: 12px; padding: 0; margin-left: 2px;" onclick="closeVideoWindow()">X</div>
                </div>
            </div>
            
            <div id="videoContainer" class="video-container-wrapper">
                <video id="mediaVideo" controls>
                    <source src="" type="video/mp4">
                    Browser Anda tidak mendukung tag video.
                </video>
            </div>
        </div>


        <!-- Ikon Desktop -->
        <div class="flex flex-col items-start p-2">
            <div class="desktop-icon" onclick="openBirthdayWindow(); closeStartMenu();">
                <div class="icon-box">üéÅ</div>
                <span class="text-xs text-white">present.exe</span>
            </div>
            <div class="desktop-icon" onclick="openMusicWindow(); closeStartMenu();">
                <div class="icon-box">üéß</div>
                <span class="text-xs text-white">music.mp3</span>
            </div>
            <div class="desktop-icon" onclick="openCakeWindow(); closeStartMenu();">
                <div class="icon-box">üéÇ</div>
                <span class="text-xs text-white">cake.me</span>
            </div>
            <div class="desktop-icon" onclick="openGalleryWindow(); closeStartMenu();">
                <div class="icon-box">üñºÔ∏è</div>
                <span class="text-xs text-white">gallery.jpg</span>
            </div>
            <div class="desktop-icon" onclick="openNotepadWindow(); closeStartMenu();">
                <div class="icon-box">üìù</div>
                <span class="text-xs text-white">notepad.exe</span>
            </div>
        </div>
        
        <!-- Taskbar -->
        <div class="taskbar">
            <div class="start-button w95-raised" id="startButton" onclick="toggleStartMenu()">
                <span class="mr-1">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1 1L1 15L15 15L15 1L1 1Z" fill="#C0C0C0" stroke="black" stroke-width="1"/>
                        <path d="M1 1L15 1L15 15L1 15L1 1Z" fill="#C0C0C0" stroke="black" stroke-width="1"/>
                        <path d="M3 3H13V13H3V3Z" fill="#808080" stroke="black" stroke-width="1"/>
                        <rect x="5" y="5" width="6" height="6" fill="#000080"/>
                    </svg>
                </span>
                Start
            </div>
            
            <div class="flex-grow"></div> 

            <div class="w95-sunken taskbar-time">
                <span id="currentTime">00:00 AM</span>
            </div>
        </div>
    </div>

    <script>
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const loadingDialog = document.getElementById('loading-dialog');
        const desktop = document.getElementById('desktop');
        const startMenu = document.getElementById('start-menu');
        const startButton = document.getElementById('startButton');
        const shutdownScreen = document.getElementById('shutdown-screen');
        
        let maxZIndex = 20;

        let progress = 0;
        const totalDuration = 3000; 
        const updateInterval = 50; 
        
        const hbdAudio = document.getElementById('hbdAudio');
        let isPlaying = false; 
        let isDraggingVolume = false; 
        let isDraggingTime = false; 
        
        // Data Galeri - Menggunakan nama file lokal sesuai permintaan
        const galleryData = [
            { id: 1, name: 'img1.jpg', url: './img1.jpg', caption: 'Momen Awal' },
            { id: 2, name: 'img2.jpg', url: './img2.jpg', caption: 'Lagi Senang' },
            { id: 3, name: 'img3.jpg', url: './img3.jpg', caption: 'Perjalanan' },
            { id: 4, name: 'img4.jpg', url: './img4.jpg', caption: 'Senyuman Terbaik' },
        ];
        let currentImageIndex = 0; 

        /**
         * Mengatur fokus jendela (z-index).
         */
        function focusWindow(windowElement) {
            maxZIndex++;
            windowElement.style.zIndex = maxZIndex;
        }
        
        /**
         * Menyiapkan fungsi drag and drop untuk jendela.
         */
        function setupWindowDragging() {
            const titleBars = document.querySelectorAll('.w95-title-bar[data-draggable]');

            titleBars.forEach(titleBar => {
                const windowId = titleBar.getAttribute('data-draggable');
                const windowElement = document.getElementById(windowId);

                let isDragging = false;
                let offsetX, offsetY;
                
                const startDrag = (clientX, clientY) => {
                    isDragging = true;
                    if (windowElement.style.position !== 'absolute') {
                        windowElement.style.position = 'absolute';
                    }
                    
                    const rect = windowElement.getBoundingClientRect();
                    windowElement.style.transform = 'none'; 
                    offsetX = clientX - rect.left;
                    offsetY = clientY - rect.top;
                    
                    focusWindow(windowElement);
                };

                const drag = (clientX, clientY) => {
                    if (!isDragging) return;
                    
                    const newLeft = clientX - offsetX;
                    const newTop = clientY - offsetY;
                    
                    const maxX = desktop.clientWidth - windowElement.offsetWidth;
                    const maxY = desktop.clientHeight - windowElement.offsetHeight;

                    windowElement.style.left = Math.max(0, Math.min(newLeft, maxX)) + 'px';
                    windowElement.style.top = Math.max(0, Math.min(newTop, maxY)) + 'px';
                };

                const stopDrag = () => {
                    isDragging = false;
                };

                // --- Event Listeners ---
                titleBar.addEventListener('mousedown', (e) => {
                    if (e.target.closest('.w95-button')) return; 
                    e.preventDefault();
                    startDrag(e.clientX, e.clientY);
                });

                document.addEventListener('mousemove', (e) => drag(e.clientX, e.clientY));
                document.addEventListener('mouseup', stopDrag);

                titleBar.addEventListener('touchstart', (e) => {
                    if (e.target.closest('.w95-button')) return;
                    e.preventDefault();
                    const touch = e.touches[0];
                    startDrag(touch.clientX, touch.clientY);
                }, { passive: false });

                document.addEventListener('touchmove', (e) => {
                    if (!isDragging) return;
                    e.preventDefault();
                    const touch = e.touches[0];
                    drag(touch.clientX, touch.clientY);
                }, { passive: false });

                document.addEventListener('touchend', stopDrag);
                
                windowElement.addEventListener('mousedown', () => focusWindow(windowElement));
                windowElement.addEventListener('touchstart', () => focusWindow(windowElement));
            });
        }
        
        /**
         * Mengubah detik menjadi format MM:SS.
         */
        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = Math.floor(totalSeconds % 60);
            return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        /**
         * Simulates the loading process.
         */
        function startLoading(onCompleteCallback = onLoadingComplete) {
            loadingDialog.style.display = 'block';
            desktop.style.display = 'none';
            progressBar.style.width = '0%';
            progressText.textContent = '0% Selesai';
            progressBar.classList.add('active');
            
            const startTime = Date.now();
            
            const interval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                progress = Math.min(100, Math.floor((elapsed / totalDuration) * 100));

                progressBar.style.width = progress + '%';
                progressText.textContent = progress + '% Selesai';

                if (progress >= 100) {
                    clearInterval(interval);
                    progressBar.classList.remove('active');
                    setTimeout(onCompleteCallback, 500); 
                }
            }, updateInterval);
        }

        /**
         * Hides the loading dialog and shows the desktop environment.
         */
        function onLoadingComplete() {
            loadingDialog.style.display = 'none';
            document.body.style.display = 'block';
            desktop.style.display = 'flex'; 
            
            openBirthdayWindow();
            
            // Setup hanya dilakukan sekali
            if (!hbdAudio.initialized) {
                setupVolumeSlider();
                setupTimeBar();
                setupAudioListeners();
                setupWindowDragging(); 
                hbdAudio.initialized = true;
            }
        }
        
        // --- FUNGSI MENU START ---
        function toggleStartMenu() {
            const isVisible = startMenu.style.display === 'flex';
            if (isVisible) {
                closeStartMenu();
            } else {
                startMenu.style.display = 'flex';
                // Tekan tombol Start secara visual
                startButton.style.borderColor = '#000000 #ffffff #ffffff #000000';
                startButton.style.boxShadow = 'inset 1px 1px 0 #000000';
            }
        }
        
        function closeStartMenu() {
            startMenu.style.display = 'none';
            // Kembalikan tombol Start ke posisi normal
            startButton.style.borderColor = '#ffffff #000000 #000000 #ffffff';
            startButton.style.boxShadow = '1px 1px 0 #000000';
        }
        
        function handleStartMenuAction(action) {
            closeStartMenu();

            switch (action) {
                case 'ucapan':
                    openBirthdayWindow();
                    break;
                case 'kue':
                    openCakeWindow();
                    break;
                case 'notepad':
                    openNotepadWindow();
                    break;
                case 'restart':
                    handleRestart();
                    break;
                case 'tentang':
                    showMessageDialog('Tentang Sistem', 'Sistem Ulang Tahun versi 95.27. Dibuat dengan cinta dan nostalgia. (c) 2025');
                    break;
                case 'shutdown':
                    handleShutdown();
                    break;
                default:
                    // do nothing
            }
        }
        
        // Menutup menu start jika mengklik di luar
        document.addEventListener('mousedown', (e) => {
            const target = e.target;
            // Tutup jika tidak mengklik menu itu sendiri atau tombol start
            if (startMenu.style.display === 'flex' && !startMenu.contains(target) && target !== startButton && !startButton.contains(target)) {
                closeStartMenu();
            }
        });
        
        // --- FUNGSI JENDELA NOTEPAD ---
        function openNotepadWindow() {
            const notepadWindow = document.getElementById('notepad-window');
            notepadWindow.style.display = 'flex';
            focusWindow(notepadWindow);
        }

        function closeNotepadWindow() {
            const notepadWindow = document.getElementById('notepad-window');
            notepadWindow.style.display = 'none';
        }

        // --- FUNGSI JENDELA PRESENT.EXE ---
        function openBirthdayWindow() {
            const birthdayWindow = document.getElementById('birthday-window');
            birthdayWindow.style.display = 'flex';
            focusWindow(birthdayWindow);
        }

        function closeBirthdayWindow() {
            const birthdayWindow = document.getElementById('birthday-window');
            birthdayWindow.style.display = 'none';
        }

        // --- FUNGSI JENDELA CAKE.ME ---
        function openCakeWindow() {
            const cakeWindow = document.getElementById('cake-window');
            cakeWindow.style.display = 'flex';
            focusWindow(cakeWindow);
        }

        function closeCakeWindow() {
            const cakeWindow = document.getElementById('cake-window');
            cakeWindow.style.display = 'none';
            closeMessageDialog(); 
        }

        // --- FUNGSI KOTAK PESAN GENERIC (Pengganti alert()) ---
        function showMessageDialog(title, contentHTML) {
            const messageDialog = document.getElementById('message-dialog');
            document.getElementById('messageTitle').textContent = title;
            document.getElementById('messageContent').innerHTML = contentHTML;
            messageDialog.style.display = 'flex';
            focusWindow(messageDialog);
        }
        
        function closeMessageDialog() {
            const messageDialog = document.getElementById('message-dialog');
            messageDialog.style.display = 'none';
        }

        // --- FUNGSI PRINT SIMULATION (BARU) ---
        function generatePhotoStrip(templateClass, images, footerText) {
            let imagesHtml = images.map(img => `
                <div class="strip-image-frame">
                    <img src="${img.url}" alt="${img.caption}"
                        onerror="this.onerror=null; this.src='https://placehold.co/80x70/c0c0c0/000000?text=${img.name.replace('.jpg', '')}';">
                </div>
            `).join('');

            return `
                <div class="photo-strip-base ${templateClass}">
                    ${imagesHtml}
                    <div class="strip-text-bottom">${footerText}</div>
                </div>
            `;
        }

        function openPrintSimulation() {
            const container = document.getElementById('photoStripContainer');
            const printWindow = document.getElementById('print-simulation-window');
            const statusText = document.getElementById('printStatusText');

            // Tampilkan status loading awal
            container.innerHTML = '<div class="loading-spinner"></div><p class="text-sm text-gray-700">Memproses cetakan...</p>';
            statusText.textContent = 'Sedang Mencetak Dokumen...';
            printWindow.style.display = 'flex';
            focusWindow(printWindow);
            
            setTimeout(() => {
                // Menggunakan 4 gambar pertama
                const images = galleryData.slice(0, 4);

                // Generasi 3 strip foto dengan template berbeda
                const strip1 = generatePhotoStrip('strip-template-1', images, 'GOOD VIBES & SMILES');
                const strip2 = generatePhotoStrip('strip-template-2', images, 'üíñ You are My Love üíñ');
                const strip3 = generatePhotoStrip('strip-template-3', images, 'Always happy together');
                
                // Injeksi ke container
                container.innerHTML = strip1 + strip2 + strip3;
                statusText.textContent = 'Dokumen telah selesai dicetak.';

            }, 1500); // Simulasi waktu cetak 1.5 detik
        }

        function closePrintSimulation() {
            document.getElementById('print-simulation-window').style.display = 'none';
        }
        
        /**
         * Mengonversi semua photo strip menjadi gambar PNG dan memicu unduhan.
         */
        async function downloadStrips() {
            const strips = document.querySelectorAll('#photoStripContainer .photo-strip-base');
            const statusText = document.getElementById('printStatusText');
            
            if (strips.length === 0) {
                 showMessageDialog('Peringatan', 'Tidak ada hasil cetak yang ditemukan. Silakan klik "Cetak" terlebih dahulu.');
                 return;
            }

            statusText.textContent = 'Memproses unduhan... Jangan tutup jendela ini.';
            
            let downloadCount = 0;

            for (let i = 0; i < strips.length; i++) {
                const strip = strips[i];
                // Hilangkan efek hover/transformasi sebelum mengonversi
                strip.style.transform = 'none'; 
                
                // html2canvas options: scale for better resolution, useCORS for external images
                await html2canvas(strip, { 
                    scale: 3, 
                    useCORS: true,
                    // Pastikan background color strip template dipertahankan
                    backgroundColor: null 
                }).then(canvas => {
                    // Buat link unduhan
                    const imageURL = canvas.toDataURL("image/png");
                    const link = document.createElement('a');
                    
                    // Gunakan nama file yang berbeda untuk setiap strip
                    let filename = `PhotoStrip_${i + 1}_${new Date().getFullYear()}.png`;
                    
                    link.href = imageURL;
                    link.download = filename;
                    
                    // Pemicu klik link untuk memulai unduhan
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    downloadCount++;
                }).catch(error => {
                    console.error("Gagal mengonversi strip ke gambar:", error);
                    showMessageDialog('Error Unduh', `Gagal mengunduh Photo Strip ${i + 1}. Pastikan file gambar (img1.jpg, dll.) telah diunggah.`);
                });
                
                // Kembalikan efek hover
                strip.style.transform = ''; 
            }
            
            statusText.textContent = `Selesai mengunduh ${downloadCount} dokumen.`;
            
            if (downloadCount > 0 && downloadCount === strips.length) {
                showMessageDialog('Unduhan Berhasil', 'Semua photo strip telah berhasil diunduh ke perangkat Anda!');
            }
        }


        // --- FUNGSI JENDELA VIDEO PLAYER (Tanpa Fullscreen Otomatis) ---
        function openVideoWindow(videoName, videoSource) {
            closeGalleryWindow();
            const videoWindow = document.getElementById('video-window');
            const videoElement = document.getElementById('mediaVideo');
            const titleBarText = document.getElementById('videoTitleBar');
            
            videoElement.src = videoSource;
            titleBarText.textContent = `MEDIA PLAYER - ${videoName}`;
            
            videoWindow.style.display = 'flex';
            focusWindow(videoWindow);
            
            // Muat ulang video dan coba putar
            videoElement.load();
            videoElement.play().then(() => {
                // Otomatis masuk ke mode layar penuh (Fullscreen)
                if (videoElement.requestFullscreen) {
                    videoElement.requestFullscreen();
                } else if (videoElement.webkitRequestFullscreen) { /* Safari */
                    videoElement.webkitRequestFullscreen();
                } else if (videoElement.msRequestFullscreen) { /* IE11 */
                    videoElement.msRequestFullscreen();
                }
            }).catch(error => {
                console.error("Autoplay/Play Gagal:", error);
                let errorMessage = `Browser Anda mungkin memblokir putar otomatis. Silakan klik tombol play (‚ñ∂) pada pemutar video.`;
                
                // Cek jika error 404/file tidak ditemukan
                if (error.message && error.message.includes('404') || error.message.includes('file not found')) {
                     errorMessage = `File video <strong>'${videoSource.replace('./', '')}'</strong> tidak ditemukan. Pastikan Anda sudah mengunggahnya.`;
                }
                
                showMessageDialog('Video Error', errorMessage);
            });
        }
        
        /**
         * Menutup jendela video.
         */
        function closeVideoWindow() {
            const videoWindow = document.getElementById('video-window');
            const videoElement = document.getElementById('mediaVideo');
            
            videoElement.pause();
            videoElement.src = ""; // Kosongkan src untuk menghemat memori
            
            videoWindow.style.display = 'none';
        }

        
        // --- FUNGSI JENDELA GALLERY VIEWER ---
        function updateGalleryView() {
            const image = galleryData[currentImageIndex];
            const prevButton = document.getElementById('prevButton');
            const nextButton = document.getElementById('nextButton');
            const currentImageElement = document.getElementById('currentImage');

            // Set URL gambar
            currentImageElement.src = image.url;
            document.getElementById('imageCaption').textContent = image.caption; 
            document.getElementById('imageCounter').textContent = `${currentImageIndex + 1}/${galleryData.length}`;
            
            // Efek polaroid miring random
            const polaroidElement = document.querySelector('.polaroid');
            const rotation = (Math.random() * 6 - 3).toFixed(2); 
            polaroidElement.style.transform = `rotate(${rotation}deg)`;

            // Kontrol tombol navigasi
            const isFirst = currentImageIndex === 0;
            const isLast = currentImageIndex === galleryData.length - 1;

            prevButton.disabled = isFirst;
            prevButton.classList.toggle('w95-sunken', isFirst);
            prevButton.classList.toggle('w95-raised', !isFirst);

            nextButton.disabled = isLast;
            nextButton.classList.toggle('w95-sunken', isLast);
            nextButton.classList.toggle('w95-raised', !isLast);
        }

        function openGalleryWindow() {
            const galleryWindow = document.getElementById('gallery-window');
            galleryWindow.style.display = 'flex';
            currentImageIndex = 0; 
            updateGalleryView();
            focusWindow(galleryWindow);
        }

        function closeGalleryWindow() {
            const galleryWindow = document.getElementById('gallery-window');
            galleryWindow.style.display = 'none';
        }

        function showPrevImage() {
            if (currentImageIndex > 0) {
                currentImageIndex--;
                updateGalleryView();
            }
        }

        function showNextImage() {
            if (currentImageIndex < galleryData.length - 1) {
                currentImageIndex++;
                updateGalleryView();
            }
        }
        
        // --- FUNGSI JENDELA MUSIC PLAYER ---
        function openMusicWindow() {
            const musicWindow = document.getElementById('music-window');
            musicWindow.style.display = 'flex';
            focusWindow(musicWindow);
        }

        function closeMusicWindow() {
            const musicWindow = document.getElementById('music-window');
            musicWindow.style.display = 'none';
            if (isPlaying) {
                hbdAudio.pause();
            }
            isPlaying = false;
            document.getElementById('playbackStatus').textContent = 'READY';
            document.getElementById('playIcon').textContent = '‚ñ∂';
        }
        
        function togglePlayback() {
            const statusElement = document.getElementById('playbackStatus');
            const iconElement = document.getElementById('playIcon');
            const trackTitle = document.getElementById('trackTitle');
            
            if (isNaN(hbdAudio.duration)) {
                statusElement.textContent = 'ERROR: hbd.mp3 TIDAK DITEMUKAN';
                trackTitle.textContent = 'hbd.mp3 (Gagal)';
                showMessageDialog('Audio Error', 'File audio hbd.mp3 gagal dimuat. Pastikan file tersebut sudah diunggah.');
                return;
            }
            
            isPlaying = !isPlaying;
            
            if (isPlaying) {
                hbdAudio.play().catch(error => {
                    console.error("Gagal memutar audio:", error);
                    statusElement.textContent = 'ERROR MEMUTAR (DIJEDA)';
                    isPlaying = false;
                    iconElement.textContent = '‚ñ∂';
                    showMessageDialog('Audio Error', 'Browser memblokir pemutaran otomatis. Silakan coba lagi setelah berinteraksi dengan halaman.');
                });
                statusElement.textContent = 'MEMUTAR';
                iconElement.textContent = '‚ñ†'; 
                trackTitle.textContent = 'MEMUTAR hbd.mp3';
            } else {
                hbdAudio.pause();
                statusElement.textContent = 'DIJEDA';
                iconElement.textContent = '‚ñ∂'; 
                trackTitle.textContent = 'DIJEDA';
            }
        }
        
        function setupVolumeSlider() {
            const sliderContainer = document.getElementById('volumeSliderContainer');
            const sliderFill = document.getElementById('volumeSliderFill');
            
            if (!sliderContainer || !sliderFill) return;

            hbdAudio.volume = 0.7;

            const handleVolumeChange = (clientX) => {
                const rect = sliderContainer.getBoundingClientRect();
                let newVolumePx = clientX - rect.left;
                
                if (newVolumePx < 0) newVolumePx = 0;
                if (newVolumePx > rect.width) newVolumePx = rect.width;

                const volumeRatio = newVolumePx / rect.width;

                sliderFill.style.width = (volumeRatio * 100) + '%';
                hbdAudio.volume = volumeRatio;
                
                const volumeLevel = Math.round(volumeRatio * 100);
                document.getElementById('playbackStatus').textContent = `Volume: ${volumeLevel}%`;
            };

            sliderContainer.addEventListener('mousedown', (e) => {
                isDraggingVolume = true;
                handleVolumeChange(e.clientX);
            });

            document.addEventListener('mousemove', (e) => {
                if (isDraggingVolume) {
                    e.preventDefault(); 
                    handleVolumeChange(e.clientX);
                }
            });

            document.addEventListener('mouseup', () => {
                isDraggingVolume = false;
                if (!hbdAudio.paused) {
                    document.getElementById('playbackStatus').textContent = 'MEMUTAR';
                }
            });
            
            // Touch listeners
            sliderContainer.addEventListener('touchstart', (e) => {
                isDraggingVolume = true;
                handleVolumeChange(e.touches[0].clientX);
            });

            document.addEventListener('touchmove', (e) => {
                if (isDraggingVolume) {
                    e.preventDefault(); 
                    handleVolumeChange(e.touches[0].clientX);
                }
            });

            document.addEventListener('touchend', () => {
                isDraggingVolume = false;
                if (!hbdAudio.paused) {
                    document.getElementById('playbackStatus').textContent = 'MEMUTAR';
                }
            });
        }
        
        function setupTimeBar() {
            const timeBarContainer = document.querySelector('.time-bar-container');
            
            const handleTimeChange = (clientX) => {
                const rect = timeBarContainer.getBoundingClientRect();
                let newTimePx = clientX - rect.left;
                
                if (newTimePx < 0) newTimePx = 0;
                if (newTimePx > rect.width) newTimePx = rect.width;

                const timeRatio = newTimePx / rect.width;
                
                if (hbdAudio.duration && isFinite(hbdAudio.duration)) {
                    hbdAudio.currentTime = hbdAudio.duration * timeRatio;
                }
            };
            
            timeBarContainer.addEventListener('mousedown', (e) => {
                isDraggingTime = true;
                handleTimeChange(e.clientX);
            });
            
            document.addEventListener('mousemove', (e) => {
                if (isDraggingTime) {
                    e.preventDefault();
                    handleTimeChange(e.clientX);
                }
            });

            document.addEventListener('mouseup', () => {
                isDraggingTime = false;
            });
            
            // Touch listeners
            timeBarContainer.addEventListener('touchstart', (e) => {
                isDraggingTime = true;
                handleTimeChange(e.touches[0].clientX);
            });
            
            document.addEventListener('touchmove', (e) => {
                if (isDraggingTime) {
                    e.preventDefault();
                    handleTimeChange(e.touches[0].clientX);
                }
            });

            document.addEventListener('touchend', () => {
                isDraggingTime = false;
            });
        }
        
        function setupAudioListeners() {
            const timeBarProgress = document.getElementById('timeBarProgress');
            const currentTimeDisplay = document.getElementById('currentTimeDisplay');
            const durationDisplay = document.getElementById('durationDisplay');

            hbdAudio.addEventListener('loadedmetadata', () => {
                if (isFinite(hbdAudio.duration)) {
                    durationDisplay.textContent = formatTime(hbdAudio.duration);
                    document.getElementById('playbackStatus').textContent = 'READY';
                } else {
                    durationDisplay.textContent = '00:00';
                }
            });

            hbdAudio.addEventListener('timeupdate', () => {
                if (isDraggingTime) return; 
                
                if (isFinite(hbdAudio.duration) && hbdAudio.duration > 0) {
                    const ratio = hbdAudio.currentTime / hbdAudio.duration;
                    timeBarProgress.style.width = (ratio * 100) + '%';
                    currentTimeDisplay.textContent = formatTime(hbdAudio.currentTime);
                }
            });
            
            hbdAudio.addEventListener('ended', () => {
                isPlaying = false;
                document.getElementById('playbackStatus').textContent = 'SELESAI';
                document.getElementById('playIcon').textContent = '‚ñ∂';
                timeBarProgress.style.width = '100%'; 
                currentTimeDisplay.textContent = durationDisplay.textContent;
            });

            hbdAudio.addEventListener('error', (e) => {
                const statusElement = document.getElementById('playbackStatus');
                statusElement.textContent = 'ERROR MEMUAT FILE hbd.mp3';
                console.error("Gagal memuat audio. Pastikan 'hbd.mp3' berada di direktori yang sama.", e);
            });
        }

        // --- FUNGSI RESTART & SHUTDOWN ---

        function closeAllWindows() {
             // Close all windows
             document.querySelectorAll('.w95-window').forEach(win => win.style.display = 'none');
             // Stop audio
             hbdAudio.pause();
             isPlaying = false;
             // Ensure video and print window are also closed
             closeVideoWindow();
             closePrintSimulation();
        }

        function handleRestart() {
            closeAllWindows();
            
            // 1. Tampilkan loading screen dengan title Restart
            loadingDialog.querySelector('.title-bar-text').textContent = "Restarting Windows...";
            loadingDialog.querySelector('strong').textContent = "Memulai Ulang Sistem Ulang Tahun...";
            
            startLoading(() => {
                // Setelah loading selesai, kembalikan ke kondisi awal desktop
                loadingDialog.querySelector('.title-bar-text').textContent = "Memuat Sistem Berkas...";
                loadingDialog.querySelector('strong').textContent = "Memuat Antarmuka Desktop 32-bit (Simulasi)...";
                onLoadingComplete();
            });
        }

        function handleShutdown() {
            closeAllWindows();
            
            // 1. Tampilkan loading screen dengan title Shutdown
            loadingDialog.querySelector('.title-bar-text').textContent = "Shutting Down...";
            loadingDialog.querySelector('strong').textContent = "Mematikan Sistem...";
            
            shutdownScreen.style.opacity = 0; // Pastikan opacity 0 sebelum loading
            shutdownScreen.style.display = 'flex';
            
            startLoading(() => {
                // 2. Sembunyikan loading screen dan tampilkan Shutdown Screen dengan efek
                loadingDialog.style.display = 'none';
                desktop.style.display = 'none';
                
                // Transisi halus ke layar hitam penuh
                setTimeout(() => {
                    shutdownScreen.style.opacity = 1;
                }, 50); 
            });
        }


        // Setel waktu di Taskbar
        function updateTime() {
            const now = new Date();
            let hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12;
            hours = hours ? hours : 12; 
            document.getElementById('currentTime').textContent = `${hours}:${minutes} ${ampm}`;
        }
        
        // Start the loading simulation and time update when the window loads
        window.onload = () => {
            startLoading();
            setInterval(updateTime, 1000);
            updateTime();
        };

        // Prevent controls from doing anything (for aesthetics)
        document.querySelectorAll('.w95-button, .start-button').forEach(button => {
            button.addEventListener('click', (e) => {
                const isControl = e.currentTarget.textContent.trim() === '_' || e.currentTarget.textContent.trim() === '‚òê';
                const isMenu = e.currentTarget.classList.contains('menu-item');
                
                if (isControl || isMenu) {
                    // Hanya mencegah aksi default, biarkan fungsi onclick berjalan
                }
            });
        });

    </script>
</body>
</html>
